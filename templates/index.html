<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="/static/styles.css">

    <meta charset="UTF-8">
    <title>Horoscope WebApp</title>
    <script>
window.onload = function() {
    const form = document.querySelector('form');
    form.addEventListener('submit', async function(event) {
        event.preventDefault();
        await submitForm();
    });


    async function submitForm() {
        const astrologySign = document.getElementById('astrology_sign').value;
        const name = document.getElementById('name').value;
        const horoscopeDisplay = document.getElementById('horoscope_display');
        const loading = document.getElementById('loading');

        // Hide any existing horoscope and show the loading message
        if (horoscopeDisplay.children.length > 0) {
            horoscopeDisplay.children[0].style.display = 'none';
        }
        loading.style.display = 'block';

        const response = await fetch('/get_horoscope', {
            method: 'POST',
            body: new FormData(document.querySelector('form'))
        });

        const data = await response.blob();
        let img = horoscopeDisplay.querySelector('img');
        if (!img) {
            img = document.createElement('img');
            horoscopeDisplay.appendChild(img);
        }
        img.src = URL.createObjectURL(data);

        // Hide the loading message
        loading.style.display = 'none';
    }
};
</script>

</head>
<body>
    <h1>Daily Horoscope</h1>
    <form>
        <label for="name">Name</label>
        <input type="text" id="name" name="name" required><br>
        <label for="astrology_sign">Astrology Sign:</label>
<select id="astrology_sign" name="astrology_sign">
    <option value="Aries">Aries</option>
    <option value="Taurus">Taurus</option>
    <option value="Gemini">Gemini</option>
    <option value="Cancer">Cancer</option>
    <option value="Leo">Leo</option>
    <option value="Virgo">Virgo</option>
    <option value="Libra">Libra</option>
    <option value="Scorpio">Scorpio</option>
    <option value="Sagittarius">Sagittarius</option>
    <option value="Capricorn">Capricorn</option>
    <option value="Aquarius">Aquarius</option>
    <option value="Pisces">Pisces</option>
</select><br>
        <label for="area">Horoscope Area</label>
        <select id="area" name="area">
            <option value="Love">Love</option>
            <option value="Career">Career</option>
            <option value="Health">Health</option>
            <option value="Mood">Mood</option>
        </select><br>

        <button type="submit">Get Horoscope</button>
    </form>
   <div id="horoscope_display">
    {% if horoscope %}
        <p>{{ horoscope }}</p>
    {% endif %}
</div>
<p id="loading" style="display:none;">Reading the stars...</p>






</body>
</html>
